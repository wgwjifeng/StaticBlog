<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="google15310e762694357f.html" />













  
  
  <link href="/StaticBlog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/StaticBlog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/StaticBlog/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="HTTP,Network," />





  <link rel="alternate" href="/StaticBlog/rss2.xml" title="MeeSong's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/StaticBlog/uploads/avatar.jpg?v=5.1.1" />






<meta name="description" content="HTTP 1.1Web 使用一种名为 HTTP(HyperText Transfer Protocol, 超文本传输协议/超文本转移协议)的协议作为规范，完成从客户端到服务端等一系列运作流程。">
<meta name="keywords" content="HTTP,Network">
<meta property="og:type" content="article">
<meta property="og:title" content="http &amp; http2  学习">
<meta property="og:url" content="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/index.html">
<meta property="og:site_name" content="MeeSong&#39;s Blog">
<meta property="og:description" content="HTTP 1.1Web 使用一种名为 HTTP(HyperText Transfer Protocol, 超文本传输协议/超文本转移协议)的协议作为规范，完成从客户端到服务端等一系列运作流程。">
<meta property="og:image" content="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/TCPIP.png">
<meta property="og:image" content="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/报文结构1.png">
<meta property="og:image" content="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/报文结构2.png">
<meta property="og:image" content="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/请求报文.png">
<meta property="og:image" content="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/响应报文.png">
<meta property="og:updated_time" content="2017-05-12T03:58:36.409Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="http &amp; http2  学习">
<meta name="twitter:description" content="HTTP 1.1Web 使用一种名为 HTTP(HyperText Transfer Protocol, 超文本传输协议/超文本转移协议)的协议作为规范，完成从客户端到服务端等一系列运作流程。">
<meta name="twitter:image" content="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/TCPIP.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/StaticBlog/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/"/>





  <title>http & http2  学习 | MeeSong's Blog</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-80255644-1', 'auto');
  ga('send', 'pageview');
</script>











  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/StaticBlog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MeeSong's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">探索有趣的事物~</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/StaticBlog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/StaticBlog/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/StaticBlog/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/StaticBlog/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/StaticBlog/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/StaticBlog/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://meesong.github.io/StaticBlog/Network/cj2vgyg2s001i2tpo6hlvw29n/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="MeeSong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/StaticBlog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MeeSong's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">http & http2  学习</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-31T11:42:35+08:00">
                2016-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/StaticBlog/categories/Network/" itemprop="url" rel="index">
                    <span itemprop="name">Network</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP 1.1"></a>HTTP 1.1</h1><p>Web 使用一种名为 HTTP(HyperText Transfer Protocol, 超文本传输协议/超文本转移协议)的协议作为规范，完成从客户端到服务端等一系列运作流程。<br><a id="more"></a><br><a href="https://zh.wikipedia.org/wiki/TCP/IP%E5%8D%8F%E8%AE%AE%E6%97%8F" target="_blank" rel="external">TCP/IP 协议族</a> 里重要的一点就是分层。TCP/IP 协议族按层次分别分为以下4层：应用层、传输层、网络层和数据链路层。</p>
<p>TCP/IP 协议族各层的作用如下：</p>
<p><strong>应用层</strong></p>
<p>应用层决定了向用户提供应用服务时通信的活动。<br>TCP/IP 协议族内预存了各类通用的应用服务，比如，FTP(File Transfer Protocol, 文件传输协议) 和 DNS(Domain Name System, 域名系统) 服务就是其中两类。</p>
<p><strong>传输层</strong></p>
<p>传输层对上层应用层提供处于网络连接中的两台计算机之间的数据传输。<br>在传输层有两个性质不同的协议：TCP(Transmission Control Protocol, 传输控制协议) 和 UDP(User ata Protocol) 用户数据报协议。</p>
<p><strong>网络层 (又名网络互连层)</strong></p>
<p>网络层用来处理在网络上流动的数据包。数据包是网络传输的最小数据单位。该层规定了通过怎样的路径 (所谓的传输路线) 到达对方计算机，并把数据包传送给对方。<br>与对方计算机之间通过多台计算机或万灵果设备进行传输时，网络层所起的作用就是在众多的选项内选择一条传输路线。</p>
<p><strong>链路层 (又名数据链路层，网络接口层)</strong></p>
<p>用来处理链接网络的硬件部分。包括控制操作系统、硬件的设备驱动，NIC(Network Interface Card, 网络适配器，即网卡)，及光纤等物理可见部分 (还包括连接器等一切传输媒介)。硬件上的范畴均在链路层的作用范围之内。</p>
<p><img src="TCPIP.png" alt=""></p>
<p>发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息。反之，接收端在层与层传输数据时，每经过一层时会把对应的首部消去。<br>这种把信息包装起来的做法称为封装 (encapsulate)。</p>
<p>详细学习见《TCP/IP 详解》</p>
<p><strong>HTTP/1.0 和 HTTP/1.1 支持的方法</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th style="text-align:left">说明</th>
<th style="text-align:left">支持的 HTTP 协议版本</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">GET</td>
<td style="text-align:left">获取资源</td>
<td style="text-align:left">1.0、1.1</td>
</tr>
<tr>
<td style="text-align:left">POST</td>
<td style="text-align:left">传输实体主体</td>
<td style="text-align:left">1.0、1.1</td>
</tr>
<tr>
<td style="text-align:left">PUT</td>
<td style="text-align:left">传输文件</td>
<td style="text-align:left">1.0、1.1</td>
</tr>
<tr>
<td style="text-align:left">HEAD</td>
<td style="text-align:left">获得报文头部</td>
<td style="text-align:left">1.0、1.1</td>
</tr>
<tr>
<td style="text-align:left">DELETE</td>
<td style="text-align:left">删除文件</td>
<td style="text-align:left">1.0、1.1</td>
</tr>
<tr>
<td style="text-align:left">OPTIONS</td>
<td style="text-align:left">询问支持的方法</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">TRACE</td>
<td style="text-align:left">追踪路径</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">CONNECT</td>
<td style="text-align:left">要求用隧道协议连接代理</td>
<td style="text-align:left">1.1</td>
</tr>
<tr>
<td style="text-align:left">LINK</td>
<td style="text-align:left">建立和资源之间的联系</td>
<td style="text-align:left">1.0</td>
</tr>
<tr>
<td style="text-align:left">UNLINK</td>
<td style="text-align:left">断开连接关系</td>
<td style="text-align:left">1.0</td>
</tr>
</tbody>
</table>
<p><strong>持久连接</strong></p>
<p>HTTP 协议的初始版本中，每进行一次 HTTP 通信就要断开一次 TCP 连接。<br>每次的请求都会造成无谓的 TCP 连接建立和断开，增加通信量的开销。<br>为了解决持久连接的问题，HTTP/1.1 和 一部分的 HTTP/1.0 相处了持久连接 (HTTP Persistent Connections, 也称为 HTTP keep-alive 或 HTTP connection reuse) 的方法。<br>持久连接的特点是，只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。</p>
<h2 id="HTTP-报文"><a href="#HTTP-报文" class="headerlink" title="HTTP 报文"></a>HTTP 报文</h2><p>用于HTTP协议交互的信息被称为 HTTP 报文。请求端 (客户端) 的 HTTP 报文叫做请求报文，响应端 (服务器端) 的叫做响应报文。HTTP 报文本身是由多行 (用 CR+LF 作换行符) 数据构成的字符串文本。<br>HTTP 报文大致可分为报文首部和报文主体两块。两个由最初出现的空行来划分。通常并不一定有报文主体。</p>
<p><img src="报文结构1.png" alt=""><br><img src="报文结构2.png" alt=""></p>
<p><strong>报文主体和实体主体</strong></p>
<ul>
<li>报文 (message)<br>是 HTTP 通信中的基本单位，由 8 位组字节流 (octet sequence, 其中 octet 为 8 个bit) 组成，通过 HTTP 通信传输。</li>
<li>实体 (entity)<br>作为请求或响应的有效载荷数据 (补充项) 被传输，其内容由实体首部和实体主体组成。</li>
</ul>
<p>HTTP 报文的主体用于传输请求或响应的实体主体。</p>
<p><strong>压缩传输的内容编码</strong></p>
<p>常用的内容编码有以下几种：</p>
<ul>
<li>gzip (GNU zip)</li>
<li>compress (UNIX 系统的标准压缩)</li>
<li>deflate (zlib)</li>
<li>identity (不进行编码)</li>
</ul>
<h2 id="HTTP-状态码"><a href="#HTTP-状态码" class="headerlink" title="HTTP 状态码"></a>HTTP 状态码</h2><table>
<thead>
<tr>
<th style="text-align:left">状态码</th>
<th style="text-align:left">类别</th>
<th style="text-align:left">原因短语</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1XX</td>
<td style="text-align:left">Informational (信息性状态码)</td>
<td style="text-align:left">接受的请求正在处理</td>
</tr>
<tr>
<td style="text-align:left">2XX</td>
<td style="text-align:left">Success (成功状态码)</td>
<td style="text-align:left">请求正常处理完毕</td>
</tr>
<tr>
<td style="text-align:left">3XX</td>
<td style="text-align:left">Redirection (重定向状态码)</td>
<td style="text-align:left">需要进行附加操作以完成请求</td>
</tr>
<tr>
<td style="text-align:left">4XX</td>
<td style="text-align:left">Client Error (客户端错误状态码)</td>
<td style="text-align:left">服务器无法处理请求</td>
</tr>
<tr>
<td style="text-align:left">5XX</td>
<td style="text-align:left">Server Error (服务器错误状态码)</td>
<td style="text-align:left">服务器处理请求出错</td>
</tr>
</tbody>
</table>
<p><strong>2XX 成功</strong></p>
<ul>
<li>200 OK</li>
<li>204 No Content</li>
<li>206 Partial Content</li>
</ul>
<p><strong>3XX 重定向</strong></p>
<ul>
<li>301 Moved Permanently</li>
<li>302 Found</li>
<li>303 See Other</li>
<li>304 Not Modified<br>虽然 304 被分在 3XX 类别中，但是和重定向没有关系。</li>
</ul>
<p><strong>4XX 客户端错误</strong></p>
<ul>
<li>400 Bad Request</li>
<li>401 Unauthorized</li>
<li>403 Forbidden</li>
<li>404 Not Found</li>
</ul>
<p><strong>5XX 服务器错误</strong></p>
<ul>
<li>500 Internal Server Error</li>
<li>503 Service Unavailable</li>
</ul>
<p><strong>状态码和状况的不一致</strong></p>
<p>不少返回的状态码响应都是错误的，但是用户可能察觉不到这点。比如 Web 应用程序内部发生错误，状态码依然返回 200 OK，这种情况也经常遇到。</p>
<h2 id="HTTP-首部"><a href="#HTTP-首部" class="headerlink" title="HTTP 首部"></a>HTTP 首部</h2><p>在请求中，HTTP 报文由方法、URL、HTTP 版本、HTTP 首部字段等部分构成。<br><img src="请求报文.png" alt=""></p>
<p>在响应中，HTTP 报文由 HTTP 版本、状态码 (数字和原因短语)、HTTP 首部字段 3 部分构成。<br><img src="响应报文.png" alt=""></p>
<p><strong>HTTP 首部字段</strong></p>
<p>HTTP 首部字段根据实际用途被分为以下4种类型：</p>
<ul>
<li>通用首部字段 (General Header Fields)<br>请求报文和响应报文两方都会使用的首部</li>
<li>请求首部字段 (Request Header Fields)<br>从客户端向服务端发送请求报文时使用的首部。补充了请求的附加内容、客户端信息、响应内容相关优先级等信息。</li>
<li>响应首部字段 (Response Header Fields)<br>从服务端向客户端返回响应报文时使用的首部。补充了响应的附加内容，也会要求客户端附加额外的内容信息。</li>
<li>实体首部字段 (Entity Header Fields)<br>针对请求报文和响应报文的额实体部分使用的首部。补充了资源内容更新时间等与实体有关的信息。</li>
</ul>
<h3 id="通用首部字段"><a href="#通用首部字段" class="headerlink" title="通用首部字段"></a>通用首部字段</h3><ul>
<li>Cache-Control<br>通过制定首部字段 Cache-Control 的指令，就能操作缓存的工作机制。</li>
</ul>
<p>Cache-Control 指令一览：</p>
<p><strong>缓存请求指令</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">指令</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">no-cache</td>
<td style="text-align:left">无</td>
<td style="text-align:left">强制向源服务器再次验证</td>
</tr>
<tr>
<td style="text-align:left">no-store</td>
<td style="text-align:left">无</td>
<td style="text-align:left">不缓存请求或响应的任何内容</td>
</tr>
<tr>
<td style="text-align:left">max-age = [秒]</td>
<td style="text-align:left">必须</td>
<td style="text-align:left">响应最大的 Age 值</td>
</tr>
<tr>
<td style="text-align:left">max-stale( = [秒])</td>
<td style="text-align:left">可省略</td>
<td style="text-align:left">接收已过期的响应</td>
</tr>
<tr>
<td style="text-align:left">min-fresh = [秒]</td>
<td style="text-align:left">必需</td>
<td style="text-align:left">期望在指定时间内的响应仍有效</td>
</tr>
<tr>
<td style="text-align:left">no-transform</td>
<td style="text-align:left">无</td>
<td style="text-align:left">代理不可更改媒体类型</td>
</tr>
<tr>
<td style="text-align:left">only-if-cached</td>
<td style="text-align:left">无</td>
<td style="text-align:left">从缓存获取资源</td>
</tr>
<tr>
<td style="text-align:left">cache-extension</td>
<td style="text-align:left">-</td>
<td style="text-align:left">新指令标记 (token)</td>
</tr>
</tbody>
</table>
<p><strong>缓存响应指令</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">指令</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">public</td>
<td style="text-align:left">无</td>
<td style="text-align:left">可向任意方提供响应的缓存</td>
</tr>
<tr>
<td style="text-align:left">private</td>
<td style="text-align:left">可省略</td>
<td style="text-align:left">仅向特定用户返回响应</td>
</tr>
<tr>
<td style="text-align:left">no-cache</td>
<td style="text-align:left">可省略</td>
<td style="text-align:left">缓存前必须先确认其有效性</td>
</tr>
<tr>
<td style="text-align:left">no-store</td>
<td style="text-align:left">无</td>
<td style="text-align:left">不缓存请求或响应的任何内容</td>
</tr>
<tr>
<td style="text-align:left">no-transform</td>
<td style="text-align:left">无</td>
<td style="text-align:left">代理不可更改媒体类型</td>
</tr>
<tr>
<td style="text-align:left">must-revalidate</td>
<td style="text-align:left">无</td>
<td style="text-align:left">可缓存但必须再向源服务器进行确认</td>
</tr>
<tr>
<td style="text-align:left">proxy-revalidate</td>
<td style="text-align:left">无</td>
<td style="text-align:left">要求中间缓存服务器缓存的响应有效性再进行确认</td>
</tr>
<tr>
<td style="text-align:left">max-age = [秒]</td>
<td style="text-align:left">必须</td>
<td style="text-align:left">响应最大的 Age 值</td>
</tr>
<tr>
<td style="text-align:left">s-maxage = [秒]</td>
<td style="text-align:left">必须</td>
<td style="text-align:left">公共缓存服务器响应的最大 Age 值</td>
</tr>
<tr>
<td style="text-align:left">cache-extension</td>
<td style="text-align:left">-</td>
<td style="text-align:left">新指令标记 (token)</td>
</tr>
</tbody>
</table>
<ul>
<li>Connection<br>Connection 首部字段具备如下两个作用：</li>
</ul>
<ol>
<li>控制不再转发给代理的首部字段</li>
<li>管理持久连接</li>
</ol>
<p><code>Connection: Upgrade</code><br><code>Connection: Keep-Alive</code><br><code>Connection: close</code></p>
<ul>
<li><p>Date<br>首部字段 Date 表明创建 HTTP 报文的日期和时间<br>HTTP/1.1 协议使用在 RFC1123 中规定的日期时间的格式<br><code>Date: Tue, 03 Jul 2012 04:40:59 GMT</code></p>
</li>
<li><p>Pragma<br>Pragma 是 HTTP/1.1 之前版本的历史遗留字段，仅作为与 HTTP/1.0 的向后兼容而定义。<br>规范定义的形式唯一：<code>Pragma: no-cache</code></p>
</li>
<li><p>Trailer<br>首部字段 Trailer 会事先说明在报文主体后记录了哪些首部字段，该字段可应用在 HTTP/1.1 版本分块传输编码时。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">Trailer: Expires</div><div class="line">...(报文主体)...</div><div class="line">Expires: Tue, 28 Sep 2004 23:59:59 GMT</div></pre></td></tr></table></figure>
</li>
<li><p>Transfer-Encoding<br>首部字段 Transfer-Encoding 规定了传输报文主体时采用的编码方式。</p>
</li>
<li><p>Upgrade<br>首部字段 Upgrade 用于检测 HTTP 协议及其他协议是否可使用更高的版本进行通信，其参数可以用来指定一个完全不同的通信协议<br>使用首部字段 Upgrade 时，需要额外指定 <code>Connection: Upgrade</code><br>对于富有首部字段 Upgrade 的请求，服务器可用 101 Switching Protocols 状态码作为响应返回。</p>
</li>
<li><p>Via<br>使用首部字段 Via 是为了追踪客户端与服务器之间的请求和响应报文的传输路径。</p>
</li>
<li><p>Warning<br>HTTP/1.1 的 Warning 首部是从 HTTP/1.0 的响应首部 (Retry-After) 演变过来的，该首部通常会告知用户一些与缓存相关的问题的警告。</p>
</li>
</ul>
<p>Warning 首部的格式如下：<br><code>Warning: [警告码] [警告的主机:端口号] &quot;[警告内容]&quot; ([日期时间])</code></p>
<p>HTTP/1.1 警告码</p>
<table>
<thead>
<tr>
<th style="text-align:left">警告码</th>
<th style="text-align:left">警告内容</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">110</td>
<td style="text-align:left">Response is stale (响应已过期)</td>
<td style="text-align:left">代理返回已过期的资源</td>
</tr>
<tr>
<td style="text-align:left">111</td>
<td style="text-align:left">Revalidation failed (再次验证失败)</td>
<td style="text-align:left">代理再验证资源有效性时失败 (服务器无法到达等原因)</td>
</tr>
<tr>
<td style="text-align:left">112</td>
<td style="text-align:left">Disconnection operation (断开连接操作)</td>
<td style="text-align:left">代理与互联网连接被故意切断</td>
</tr>
<tr>
<td style="text-align:left">113</td>
<td style="text-align:left">Heuristic expiration (试探性过期)</td>
<td style="text-align:left">响应的使用期超过24小时 (有效缓存设定时间大于24小时的情况下)</td>
</tr>
<tr>
<td style="text-align:left">199</td>
<td style="text-align:left">Miscellaneous warning (杂项警告)</td>
<td style="text-align:left">任意的警告内容</td>
</tr>
<tr>
<td style="text-align:left">214</td>
<td style="text-align:left">Transformation applied (使用了转换)</td>
<td style="text-align:left">代理对内容编码或媒体类型等执行了某些处理时</td>
</tr>
<tr>
<td style="text-align:left">299</td>
<td style="text-align:left">Miscellaneous persistent warning (持久杂项警告)</td>
<td style="text-align:left">任意的警告内容</td>
</tr>
</tbody>
</table>
<h3 id="请求首部字段"><a href="#请求首部字段" class="headerlink" title="请求首部字段"></a>请求首部字段</h3><ul>
<li><p>Accept<br>Accept 首部字段可通知服务器，用户代理能够处理的媒体类型及媒体类型的相对优先级。可使用 <code>type/subtype</code> 这种形式，一次指定多种媒体类型。<br>若想给显示的媒体类型增加优先级，则使用 <code>q=</code> 来额外表示权重值，用分号进行分割。权重值 q 的范围是 0~1 可精确到小数点后3位，且1为最大值。不指定权重 q 值时，默认权重为 q=1.0。<br><code>Accept: text/html, application/xhtml+xml, application/xml;q=0.9, */*;q=0.8</code></p>
</li>
<li><p>Accept-Charset<br>Accept-Charset 首部字段可用来通知服务器用户代理支持的字符集，及字符集的相对优先顺序。另外可一次性指定多种字符集，与首部字段 Accept 相同的是可用权重 q 值来表示相对优先级。<br><code>Accept-Charset: utf-8</code></p>
</li>
<li><p>Accept-Encoding<br>Accept-Encoding 首部字段用来告知服务器用户代理支持的内容编码及内容编码的优先级顺序。可一次性指定多种内容编码。<br><code>Accept-Encoding: gzip, deflate</code></p>
</li>
<li><p>Accept-Language<br>首部字段 Accept-Language 用来告知服务器用户代理能够处理的自然语言集，以及自然语言集的相对优先级，可一次指定多种自然语言集。<br><code>Accept-Language: zh-cn,zh;q=0.7,en-us,en;q=0.3</code></p>
</li>
<li><p>Authorization<br>首部字段 Authorization 是用来告知服务器，用户代理的认证信息 (证书值)。</p>
</li>
<li><p>Expect<br>客户端使用首部字段 Expect 来告知服务器，期望出现的某种特定行为。<br>因服务器无法理解客户端的期望做出回应而发生错误时，会返回状态码 417 Expectation Failed。<br><code>Expect: 100-continue</code></p>
</li>
<li><p>From<br>首部字段 From 用来告知服务器使用用户代理的用户的电子邮件地址。</p>
</li>
<li><p>Host<br>首部字段 Host 会告知服务器，请求的资源所处的互联网主机名和端口号。<br>Host 首部字段在 HTTP/1.1 规范内是唯一一个必须包含在请求内的首部字段。<br><code>Host: github.com</code></p>
</li>
<li><p>If-Match<br>形如 If-xxx 这种样式的请求首部字段，都可称为条件请求。服务器接收到附带条件的请求后，只有判断指定条件为真时，才会执行请求。</p>
</li>
</ul>
<p>首部字段 If-Match，属附带条件之一，它会告知服务器匹配资源所用的实体标记 (ETag) 值。</p>
<ul>
<li><p>If-Modified-Since<br>首部字段 If-Modified-Since，属附带条件之一，它会告知服务器若 If-Modified-Since 字段值早于资源的更新时间，则希望能处理该请求。</p>
</li>
<li><p>If-None-Match<br>首部字段 If-None-Match，属附带条件之一，它和 If-Match 相反。</p>
</li>
<li><p>If-Range<br>首部字段 If-Range，属附带条件之一，它告知服务器若指定的 If-Range 字段值 (ETag 值或者时间) 和请求资源的 ETag 值或时间相一致时，则作为范围请求处理，反之则返回全体资源。</p>
</li>
<li><p>If-Unmodified-Since<br>和 If-Modified-Since 相反</p>
</li>
<li><p>Max-Forwards<br>通过 TRACE 方法或 OPTIONS 方法，发送包含首部字段 Max-Forwards 的请求时，该字段以10进制整数形式指定可经过的服务器最大数目。</p>
</li>
<li><p>Proxy-Authorization<br>接收到从代理服务器发送来的认证质询时，客户端会发送包含首部字段Proxy-Authorization的请求，以便告知服务器认证所需的信息。</p>
</li>
<li><p>Range<br><code>Range: bytes=5001-10000</code><br>对于只需获取部分资源的范围请求，包含首部字段 Range 即可告知服务器资源的指定范围。</p>
</li>
<li><p>Referer<br><code>Referer: http://github.com/</code><br>首部字段 Referer 会告知服务器请求的原始资源的URL<br>会被用来爬虫和反爬虫…</p>
</li>
</ul>
<p>Referer的正确英语拼法是referrer。由于早期HTTP规范的拼写错误，为了保持向下兼容就将错就错了。其它网络技术的规范企图修正此问题，使用正确拼法，所以目前拼法不统一。</p>
<ul>
<li>TE<br>首部字段 TE 会告知服务器客户端能够处理响应的传输编码方式及相对优先级。<br>它和首部字段 Accept-Encoding 的功能很像，但是用于传输编码<br><code>TE: gzip</code></li>
</ul>
<p>除了指定传输编码之外，还可以指定伴随 trailer 字段的分块传输编码方式。只需把 trailers 赋值给该字段值。<br><code>TE: trailers</code></p>
<ul>
<li>User-Agent<br>首部字段 User-Agent 会将创建请求的浏览器和用户代理名称等信息传达给服务器。<br>爬虫要模拟浏览器就要添加该字段。</li>
</ul>
<h3 id="响应首部字段"><a href="#响应首部字段" class="headerlink" title="响应首部字段"></a>响应首部字段</h3><p>响应首部字段是由服务器向客户端返回相应报文中所使用的字段，用于补充相应的附加信息、服务器信息，以及客户端的附加要求等信息。</p>
<ul>
<li><p>Accept-Ranges<br>用来告知客户端，服务器是否能处理范围请求，以指定获取服务器端某个部分的资源。<br>可指定的字段值有两种，可处理范围请求时指定其为 bytes，反之则指定其为 none</p>
</li>
<li><p>Age<br>首部字段 Age 能告知客户端，源服务器在多久前创建了响应。字段值的单位为秒。</p>
</li>
<li><p>ETag<br>能够告知客户端实体标识</p>
</li>
<li><p>Location<br>可以讲响应接收方引导至某个与请求URL位置不同的资源。</p>
</li>
<li><p>Proxy-Authenticate<br>首部字段 Proxy-Authenticate 会把由代理服务器所要求的认证信息发送给客户端。</p>
</li>
<li><p>Retry-After<br>告知客户端应该在多久之后再次发送请求。</p>
</li>
<li><p>Server<br>告知客户端当前服务器上安装的 HTTP 服务器应用程序的信息。不单单会标出服务器上的软件应用名称，还可能包括版本号和安装时启动的可选项。</p>
</li>
<li><p>Vary<br>源服务器会向代理服务器传达关于本地缓存使用方法的命令。</p>
</li>
<li><p>WWW-Authenticate<br>用于 HTTP 访问认证。它会告知客户端用于访问请求 URL 所制定资源的认证方案 (Basic 或是 Digest) 和带参数提示的质询 (challenge)。<br>状态码 401 Unauthorized 响应中，肯定带有首部字段 WWW-Authenticate。</p>
</li>
</ul>
<h3 id="实体首部字段"><a href="#实体首部字段" class="headerlink" title="实体首部字段"></a>实体首部字段</h3><p>实体首部字段是包含在请求报文和响应报文中的实体部分所使用的首部，用于不中内容的更新时间等与实体相关的信息。</p>
<ul>
<li><p>Allow<br>用于通知客户端能够支持 Request-URL 指定资源的所有 HTTP 方法。<br>当服务器接收到不支持的 HTTP 方法是，会以状态码 405 Method Not Allowed 作为响应返回，与此同时，还会把所有能支持的 HTTP 方法写入首部字段 Allow 后返回。</p>
</li>
<li><p>Content-Encoding<br>告知客户端服务器对实体的主体部分选用的内容编码方式。</p>
</li>
<li><p>Content-Language<br>告知客户端，实体主体使用的自然语言。</p>
</li>
<li><p>Content-Length<br>告知客户端，实体主体的大小，单位字节。</p>
</li>
<li><p>Content-Location<br>给出与报文主体部分相对应的URL</p>
</li>
<li><p>Content-MD5<br>对报文主体执行 MD5 算法获得的 128 位二进制数，再通过 Base64 编码后将结果写入 Content-MD5 字段值。</p>
</li>
<li><p>Content-Range<br>告知客户端作为响应返回的实体的哪个部分符合范围请求。字段值以字节为单位，表示当前发送部分及整个实体大小。</p>
</li>
<li><p>Content-Type<br>说明了实体主体内对象的媒体类型。和首部字段 Accept 一样，字段值用 type/subtype 形式赋值。</p>
</li>
<li><p>Expires<br>将资源失效的日期告知客户端。</p>
</li>
<li><p>Last-Modified<br>知名资源最终修改的时间</p>
</li>
</ul>
<h3 id="为-Cookie-服务的首部字段"><a href="#为-Cookie-服务的首部字段" class="headerlink" title="为 Cookie 服务的首部字段"></a>为 Cookie 服务的首部字段</h3><p>Cookie 的工作机制是用户识别及状态管理。Web网站为了管理用户的状态会通过Web浏览器，把一些数据临时写入用户的计算机内。接着当用户访问该Web网站时，可通过通信方式取回之前发放的 Cookie。</p>
<ul>
<li>Set-Cookie<br>Set-Cookie 字段的属性</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">NAME=VALUE</td>
<td style="text-align:left">赋予 Cookie 的名称和其值 (必需项)</td>
</tr>
<tr>
<td style="text-align:left">expires=DATE</td>
<td style="text-align:left">Cookie 的有效期 (若不明确指定则默认为浏览器关闭前为止)</td>
</tr>
<tr>
<td style="text-align:left">path=PATH</td>
<td style="text-align:left">将服务器上的文件目录作为Cookie的适用对象 (若不指定则默认为文档所在的文件目录)</td>
</tr>
<tr>
<td style="text-align:left">domain=域名</td>
<td style="text-align:left">作为Cookie适用对象的域名 (若不指定则默认为创建Cookie的服务器的域名)</td>
</tr>
<tr>
<td style="text-align:left">Secure</td>
<td style="text-align:left">仅在HTTPS安全通信时才会发送Cookie</td>
</tr>
<tr>
<td style="text-align:left">HttpOnly</td>
<td style="text-align:left">加以限制，使Cookie不能被JavaScript脚本访问</td>
</tr>
</tbody>
</table>
<ul>
<li>Cookie<br><code>Cookie: status=enable</code><br>Cookie 会告知服务器，当客户端想获得HTTP状态管理支持时，就会在请求中包含从服务器接收到的Cookie。接收到多个Cookie时，同样可以以多个Cookie形式发送。</li>
</ul>
<h3 id="其他首部字段"><a href="#其他首部字段" class="headerlink" title="其他首部字段"></a>其他首部字段</h3><p>HTTP 首部字段是可以自行扩展的。所以在Web服务器和浏览器应用上，会出现各种非标准的首部字段。</p>
<ul>
<li><p>X-Frame-Options<br>首部字段 X-Frame-Options 属于HTTP响应首部，用于控制网站内容在其他Web网站的Frame标签内的显示问题。其主要目的是为了防止点击劫持攻击。<br><code>DENY: 拒绝</code><br><code>SAMEORIGIN: 仅同源域名下的页面 (Top-level-browsing-context) 匹配时许可。</code></p>
</li>
<li><p>X-XSS-Protection<br>首部字段 X-XSS-Protection 属于HTTP响应首部，它是针对跨站脚本攻击的一种对策，用于控制浏览器XSS防护机制的开关。<br><code>0: 将XSS过滤设置成无效状态</code><br><code>1: 将XSS过滤设置成有效状态</code></p>
</li>
<li><p>DNT<br>首部字段 DNT 属于 HTTP 请求首部，其中 DNT 是 Do Not Track 的简称，意为拒绝个人信息被手机，是表示拒绝被精准广告追踪的一种方法。<br><code>0: 同意被追踪</code><br><code>1: 拒绝被追踪</code></p>
</li>
<li><p>P3P<br>首部字段 P3P 属于 HTTP 相应首部，通过利用 P3P (The Platform for Privacy Preferences, 在线隐私偏好平台) 技术，可以让Web网站上的个人隐私变成一种仅供程序可理解的形式，以达到保护用户隐私的目的。</p>
</li>
</ul>
<h1 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP/2.0"></a>HTTP/2.0</h1><p><strong>HTTP2 的基本概念</strong><br>HTTP2 是基于SPDY的..<br>HTTP2 有着分厂明确的职责限定：</p>
<ul>
<li>它必须维持 HTTP 的范式。毕竟它只是一个让客户端发送请求到服务器的基于TCP的协议。</li>
<li>不能盖面 http:// 和 https:// 这样的 URL，也不能对其添加新的结构。使用这类URL的网站太多了，没发指望他们全部改变。</li>
<li>HTTP1的服务器和客户端依然会存在很久，所以我们必须提供HTTP1到HTTP2服务器的代理。</li>
<li>我们也要让这种代理能够将HTTP2的功能一对一的映射到HTTP1.1的客户端</li>
<li>删除或者减少协议里面那些可选的部分。虽然这并不算的上是一个需求，但是SPDY和Google的团队都非常喜欢这样。通过让协议里的所有内容都成为强制性需求，可以防止人们在实现的时候偷懒，从而规避一些将来可能发生的问题。</li>
<li>不再使用小版本号。服务器和客户端都必须确定自己是否完整兼容HTTP2或者彻底不兼容。如果将来协议需要被扩充或者变更，那么新的协议将会是HTTP3，而不是HTTP2.X</li>
</ul>
<p><strong>HTTP2和现有的URI结构</strong><br>HTTP 1.1本身就制定过“升级”的方案：提供一个首部字段， 表示允许服务器在收到旧协议请求的同时， 可以向客户端发送新协议的响应。 但这一方案往往需要多花费一次往返通信来作为升级的代价。<br>而这一代价是SPDY团队不想接受的。 因为他们只实现了基于TLS的SPDY， 所以他们开发了一个TLS的扩展去简化协议的协商。 这个扩展被称作NPN（ Next Protocol Negotiation） ， 借助于此， 服务器会通知客户端所有它支持的协议， 让客户端从中选择一个合适的来进行通讯。</p>
<p>HTTP2将TLS标记成了可选。 然而， 全球两大浏览器领导者 —— Firefox和Chrome都明确地表示， 他们只会实现基于TLS的HTTP2<br>规范中指定了TLS最低版本为1.2， 并且会有加密组的限制。</p>
<p>对于纯文本的HTTP1.1来说， 协商http2的方法就是通过给服务器发送一个带升级头部的报文。 如果服务器支持http2， 它将以“101 Switching”作为回复的状态码， 并从此开始在该连接上使用http2。 也许你很容易就发现这样一个升级的流程会需要消耗掉一整个的往返时延， 但好处是http2连接相比HTTP1可以被更大限度地重用和保持。<br>虽然有些浏览器厂商的发言人宣称他们不会实现这样的http2会话方式， 但IE团队已公开表示他们会实现， 与此同时， curl也已经支持了这种方式</p>
<p><strong>基于TLS之上的HTTP2协商</strong><br>Next Protocol Negotiation (NPN)是一个用来在TLS服务器上协商SPDY的协议。 IETF将这个非正式标准进行规范化， 从而演变成了ALPN（ Application Layer Protocol Negotiation）。ALPN会随着http2的应用被推广， 而SPDY的客户端与服务器则会继续使用NPN。<br>ALPN和NPN的主要区别在于：谁来决定该次会话所使用的协议。 在ALPN的描述中， 是让客户端先发送一个协议优先级列表给服务器， 由服务器最终选择一个合适的。 而NPN则正好相反， 客户端有着最终的决定权。</p>
<h2 id="HTTP2-协议"><a href="#HTTP2-协议" class="headerlink" title="HTTP2 协议"></a>HTTP2 协议</h2><p>HTTP2 是一个二进制协议。<br>http2会发送有着不同类型的二进制帧， 但他们都有如下的公共字段：Type, Length, Flags, StreamIdentifier和frame payload<br>规范中一共定义了10种不同的帧，其中最基础的两种分别对应于HTTP1.1的DATA和HEADERS。 </p>
<p>http2连接上传输的每个帧都关联到一个“流”。 流是一个逻辑上的联合， 一个独立的， 双向的帧序列可以通过一个http2的连接在服务端与客户端之间不断的交换数据。</p>
<p>每个单独的http2连接都可以包含多个并发的流， 这些流中交错的包含着来自两端的帧。 流既可以被客户端/服务器端单方面的建立和使用， 也可以被双方共享， 或者被任意一边关闭。 在流里面， 每一帧发送的顺序非常关键。 接收方会按照收到帧的顺序来进行处理。</p>
<p>每个流都包含一个优先级（ 也就是“权重”） ， 它被用来告诉对端哪个流更重要。 当资源有限的时候， 服务器会根据优先级来选择应该先发送哪些流。<br>借助于PRIORITY帧， 客户端同样可以告知服务器当前的流依赖于其他哪个流。 该功能让客户端能建立一个优先级“树”， 所有“子流”会依赖于“父流”的传输完成情况。</p>
<p>HTTP2 也是一种无状态的协议。</p>
<p>HPACK， HTTP/2头部压缩， 顾名思义它是一个专为http2头部设计的压缩格式。 确切的讲，它甚至被制定写入在另外一个单独的草案里。 新的格式同时引入了一些其他对策让破解压缩变得困难， 例如采用帧的可选填充和用一个bit作为标记， 来让中间人不压缩指定的头部。</p>
<p>在http2里面， 我们可以通过发送RST_STREAM帧来实现重置， 从而避免浪费带宽和中断已有的连接。</p>
<p>服务器推送，这个功能通常被称作“缓存推送”。 主要的思想是：当一个客户端请求资源X， 而服务器知道它很可能也需要资源Z的情况下， 服务器可以在客户端发送请求前， 主动将资源Z推送给客户端。 这个功能帮助客户端将Z放进缓存以备将来之需。<br>如果不需要的话， 客户端可以通过发送一个RST_STREAM帧来中止。</p>
<p>http2上面每个流都拥有自己的公示的流量窗口， 它可以限制另一端发送数据。</p>
<h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><p>协议强制规定了接收方必须读取并忽略掉所有未知帧类型的帧。 双方可以在逐跳原则（ hopby-hop basis） 基础上协商使用新的帧， 这些帧的状态无法被改变， 而且也不受流控制。</p>
<p><strong>备选服务（ Alternative Services）</strong></p>
<p>服务器将会通过发送Alt-Svc头（ 或者http2的ALTSVC帧） 来告知客户端另一个备选服务。 即另外一条指向不同的服务源、 主机或端口， 但却能获取同样内容的路由。<br>藉此， 客户端可以尝试异步的连接并使用该服务， 如果它切实可用的话。</p>
<p><strong>阻塞（ Blocked）</strong></p>
<p>这个类型的帧意味着：当服务端存在需要发送的内容， 但流控制却禁止发送任何数据时， 那么此类型的帧将会被发送且仅发送一次。 这种帧设计的目的在于， 如果你接收到了此帧， 那么连接中必然有错误发生或者是得到了低于期望的传输速度。<br>有可能移除..</p>
<h1 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h1><p>HTTP2的学习不详细，后续资料齐全再补充…</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>本文作者：</strong>
      MeeSong
    </li>
    <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/" title="http & http2  学习">https://meesong.github.io/Network/cj2vgyg2s001i2tpo6hlvw29n/</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明： </strong>
      本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0 CN</a> 许可协议。转载请注明出处！
    </li>
  </ul>


      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>如果喜欢, 请给我加个🍗~</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/StaticBlog/uploads/wechat.jpg" alt="MeeSong WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/StaticBlog/uploads/alipay.jpg" alt="MeeSong Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/StaticBlog/tags/HTTP/" rel="tag"># HTTP</a>
          
            <a href="/StaticBlog/tags/Network/" rel="tag"># Network</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/StaticBlog/Linux/cj2vgyftu00032tpo43t29rqy/" rel="next" title="ArchLinux 安装笔记">
                <i class="fa fa-chevron-left"></i> ArchLinux 安装笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/StaticBlog/Language/cj2vgyg34001x2tpop0bvibon/" rel="prev" title="《Writing Solid Python Code》 Notes">
                《Writing Solid Python Code》 Notes <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div onclick="showGitment()" id="gitment_title" class="gitment_title">显示 Gitment 评论</div>
      <div id="container" style="display:none"></div>
      <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
      <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
      <script>
      const myTheme = {
        render(state, instance) {
          const container = document.createElement('div');
          container.lang = "en-US";
          container.className = 'gitment-container gitment-root-container';
          container.appendChild(instance.renderHeader(state, instance));
          container.appendChild(instance.renderEditor(state, instance));
          container.appendChild(instance.renderComments(state, instance));
          container.appendChild(instance.renderFooter(state, instance));
          return container;
        }
      }

      function showGitment() {
        $("#gitment_title").attr("style", "display:none");
        $("#container").attr("style", "").addClass("gitment_container");
        var gitment = new Gitment({
          id: window.location.pathname,
          theme: myTheme,
          owner: 'MeeSong',
          repo: 'BlogComments',
          oauth: {
            client_id: 'ebc04c32e0a0c7e77aa6',
            client_secret: 'b5840ad7487a199656353a050223a77be4d39f3c'
          }
        });
        gitment.render('container');
      }
      </script>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/StaticBlog/uploads/avatar.jpg"
               alt="MeeSong" />
          <p class="site-author-name" itemprop="name">MeeSong</p>
           
              <p class="site-description motion-element" itemprop="description">生活就是不断地调试~</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/StaticBlog/archives">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/StaticBlog/categories/index.html">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/StaticBlog/tags/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/StaticBlog/rss2.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/MeeSong" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/MeesongKwok" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/2438280555" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP-1-1"><span class="nav-number">1.</span> <span class="nav-text">HTTP 1.1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-报文"><span class="nav-number">1.1.</span> <span class="nav-text">HTTP 报文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-状态码"><span class="nav-number">1.2.</span> <span class="nav-text">HTTP 状态码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-首部"><span class="nav-number">1.3.</span> <span class="nav-text">HTTP 首部</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#通用首部字段"><span class="nav-number">1.3.1.</span> <span class="nav-text">通用首部字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#请求首部字段"><span class="nav-number">1.3.2.</span> <span class="nav-text">请求首部字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#响应首部字段"><span class="nav-number">1.3.3.</span> <span class="nav-text">响应首部字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实体首部字段"><span class="nav-number">1.3.4.</span> <span class="nav-text">实体首部字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为-Cookie-服务的首部字段"><span class="nav-number">1.3.5.</span> <span class="nav-text">为 Cookie 服务的首部字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他首部字段"><span class="nav-number">1.3.6.</span> <span class="nav-text">其他首部字段</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP-2-0"><span class="nav-number">2.</span> <span class="nav-text">HTTP/2.0</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP2-协议"><span class="nav-number">2.1.</span> <span class="nav-text">HTTP2 协议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#扩展"><span class="nav-number">2.2.</span> <span class="nav-text">扩展</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#结束"><span class="nav-number">3.</span> <span class="nav-text">结束</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">MeeSong</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/StaticBlog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/StaticBlog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/StaticBlog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/StaticBlog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/StaticBlog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/StaticBlog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/StaticBlog/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/StaticBlog/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/StaticBlog/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/StaticBlog/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/StaticBlog/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (search_path.endsWith("json")) {
      isXml = false;
    }
    var path = "/StaticBlog/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  <script type="text/javascript" src="/StaticBlog/js/src/js.cookie.js?v=5.1.1"></script>
  <script type="text/javascript" src="/StaticBlog/js/src/scroll-cookie.js?v=5.1.1"></script>


  

</body>
</html>
